-- source include/have_innodb.inc

#
# MDEV-8297: information_schema.innodb_sys_tablestats.modified_counter doesn't change on UPDATE
#

set global innodb_stats_auto_recalc=off;

CREATE TABLE t1 (i int) ENGINE=InnoDB;

SELECT NAME, STATS_INITIALIZED, NUM_ROWS, MODIFIED_COUNTER FROM INFORMATION_SCHEMA.INNODB_SYS_TABLESTATS WHERE NAME = 'test/t1';

INSERT INTO t1 VALUES (1);
INSERT INTO t1 VALUES (2);

SELECT NAME, STATS_INITIALIZED, NUM_ROWS, MODIFIED_COUNTER FROM INFORMATION_SCHEMA.INNODB_SYS_TABLESTATS WHERE NAME = 'test/t1';

DELETE FROM t1 WHERE i = 1;

SELECT NAME, STATS_INITIALIZED, NUM_ROWS, MODIFIED_COUNTER FROM INFORMATION_SCHEMA.INNODB_SYS_TABLESTATS WHERE NAME = 'test/t1';

UPDATE t1 SET i = 4 WHERE i = 2;

SELECT NAME, STATS_INITIALIZED, NUM_ROWS, MODIFIED_COUNTER FROM INFORMATION_SCHEMA.INNODB_SYS_TABLESTATS WHERE NAME = 'test/t1';

DROP TABLE t1;

set global innodb_stats_auto_recalc=default;

# Copyright (c) 2011 The Native Client Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.
#
# This is a simple test file to see if we have things working.
# When run in self documenting mode and command free lines,
# are echoed to the output.
#
# Lines with command line options (up to and including the pound sign) are
# also copied to output. Application (ncdis) is then run on those options,
# generating corresponding output. It is assume that the text after the
# pound sign is the output generated by ncdis. Hence, this file is self
# documenting in the sense that the input matches the output.
#
# Note: Useful command line options are:
#   -i=XXXXXXXX
#           Specifies a (even length) hexidecimal value defined the sequence
#           of bytess that defines the instruction to translate.
#
#   --pc=XXXXXXXX
#           Specifies the value of the program counter, when it is pointing
#           to the instruction to be decoded. In not specified, the program
#           counter is assumed to be zero.
#
# Note: This file tests x86-32 instructions.

-i=55                                                       #00000000: 55                                           push %ebp
-i=8d742600                                                 #00000000: 8d 74 26 00                                  lea %esi, %ds:[%esi+%esp*1]
--pc=80483f8 -i=e8fffeffff                                  #080483f8: e8 ff fe ff ff                               call 0x80482fc

# Check move immediates (b8-bf).
-i=b888776655                                               #00000000: b8 88 77 66 55                               mov %eax, 0x55667788
-i=b988776655                                               #00000000: b9 88 77 66 55                               mov %ecx, 0x55667788
-i=ba88776655                                               #00000000: ba 88 77 66 55                               mov %edx, 0x55667788
-i=bb88776655                                               #00000000: bb 88 77 66 55                               mov %ebx, 0x55667788
-i=bc88776655                                               #00000000: bc 88 77 66 55                               mov %esp, 0x55667788
-i=bd88776655                                               #00000000: bd 88 77 66 55                               mov %ebp, 0x55667788
-i=be88776655                                               #00000000: be 88 77 66 55                               mov %esi, 0x55667788
-i=bf88776655                                               #00000000: bf 88 77 66 55                               mov %edi, 0x55667788

-i=66b88877                                                 #00000000: 66 b8 88 77                                  mov %ax, 0x7788
-i=66b98877                                                 #00000000: 66 b9 88 77                                  mov %cx, 0x7788
-i=66ba8877                                                 #00000000: 66 ba 88 77                                  mov %dx, 0x7788
-i=66bb8877                                                 #00000000: 66 bb 88 77                                  mov %bx, 0x7788
-i=66bc8877                                                 #00000000: 66 bc 88 77                                  mov %sp, 0x7788
-i=66bd8877                                                 #00000000: 66 bd 88 77                                  mov %bp, 0x7788
-i=66be8877                                                 #00000000: 66 be 88 77                                  mov %si, 0x7788
-i=66bf8877                                                 #00000000: 66 bf 88 77                                  mov %di, 0x7788

-i=67b888776655                                             #00000000: 67 b8 88 77 66 55                            mov %eax, 0x55667788
-i=67bf88776655                                             #00000000: 67 bf 88 77 66 55                            mov %edi, 0x55667788

# Check direct moves on 32-bit constant addresses.
-i=a044332211                                               #00000000: a0 44 33 22 11                               mov %al, [0x11223344]
# Note: The following will use %ax instead of %eax when using validator decoder
-i=66a144332211                                             #00000000: 66 a1 44 33 22 11                            mov %ax, [0x11223344]
-i=a144332211                                               #00000000: a1 44 33 22 11                               mov %eax, [0x11223344]
-i=a244332211                                               #00000000: a2 44 33 22 11                               mov [0x11223344], %al
# Note: The following entry will use %ax instead of %eax when using validator decoder
-i=66a344332211                                             #00000000: 66 a3 44 33 22 11                            mov [0x11223344], %ax
-i=a344332211                                               #00000000: a3 44 33 22 11                               mov [0x11223344], %eax

# The following don't print out the right syntax for matched instructions,
# and is intended to show the difference between the --full_decoder and --validator_decoder
# cases.
-i=0000                                                     #00000000: 00 00                                        add %ds:[%eax], %al
-i=00c0                                                     #00000000: 00 c0                                        add %al, %al
-i=01c0                                                     #00000000: 01 c0                                        add %eax, %eax
-i=0318                                                     #00000000: 03 18                                        add %ebx, %ds:[%eax]
-i=031d20000000                                             #00000000: 03 1d 20 00 00 00                            add %ebx, 0x20
-i=020400                                                   #00000000: 02 04 00                                     add %al, %ds:[%eax+%eax*1]
# The following lines test whether we recognized predefined nops.
-i=660f1f440000                                             #00000000: 66 0f 1f 44 00 00                            nop
-i=660f1f840000000000                                       #00000000: 66 0f 1f 84 00 00 00 00 00                   nop
-i=662e0f1f840000000000                                     #00000000: 66 2e 0f 1f 84 00 00 00 00 00                nop
-i=66662e0f1f840000000000                                   #00000000: 66 66 2e 0f 1f 84 00 00 00 00 00             nop
-i=6666662e0f1f840000000000                                 #00000000: 66 66 66 2e 0f 1f 84 00 00 00 00 00          nop
-i=666666662e0f1f840000000000                               #00000000: 66 66 66 66 2e 0f 1f 84 00 00 00 00 00       nop
-i=66666666662e0f1f840000000000                             #00000000: 66 66 66 66 66 2e 0f 1f 84 00 00 00 00 00    nop
-i=6666666666662e0f1f840000000000                           #00000000: 66 66 66 66 66 66 2e 0f 1f 84 00 00 00 00 00 nop

-i=0fae10                                                   #00000000: 0f ae 10                                     ldmxcsr %ds:[%eax]
-i=0fae18                                                   #00000000: 0f ae 18                                     stmxcsr %ds:[%eax]
-i=90                                                       #00000000: 90                                           nop
-i=6690                                                     #00000000: 66 90                                        nop
-i=89f6                                                     #00000000: 89 f6                                        mov %esi, %esi
-i=8d7600                                                   #00000000: 8d 76 00                                     lea %esi, %ds:[%esi]
-i=8d742600                                                 #00000000: 8d 74 26 00                                  lea %esi, %ds:[%esi+%esp*1]
-i=8db600000000                                             #00000000: 8d b6 00 00 00 00                            lea %esi, %ds:[%esi]
-i=8db42600000000                                           #00000000: 8d b4 26 00 00 00 00                         lea %esi, %ds:[%esi+%esp*1]
-i=8dbc2700000000                                           #00000000: 8d bc 27 00 00 00 00                         lea %edi, %ds:[%edi+%esp*1]
-i=8dbf00000000                                             #00000000: 8d bf 00 00 00 00                            lea %edi, %ds:[%edi]
-i=0f1f00                                                   #00000000: 0f 1f 00                                     nop
-i=0f1f4000                                                 #00000000: 0f 1f 40 00                                  nop
-i=0f1f8000000000                                           #00000000: 0f 1f 80 00 00 00 00                         nop
-i=0f1f840000000000                                         #00000000: 0f 1f 84 00 00 00 00 00                      nop
-i=0f1f440000                                               #00000000: 0f 1f 44 00 00                               nop
-i=0f0b                                                     #00000000: 0f 0b                                        ud2
